
root@salvator-x:~# cd /home/root/v4l2_test
root@salvator-x:~/v4l2_test# 
root@salvator-x:~/v4l2_test# ./vsp-unit-test-0023.sh
Testing histogram HGT with hue areas 0,255,255,255,255,255,255,255,255,255,255,255: [  671.021365] ------------[ cut here ]------------
[  671.026014] WARNING: CPU: 2 PID: 5435 at drivers/media/v4l2-core/v4l2-subdev.c:408 call_s_stream+0xd4/0xf0
[  671.035691] Modules linked in: bluetooth ecdh_generic ecc rfkill crct10dif_ce optee_rng rng_core
[  671.044520] CPU: 2 PID: 5435 Comm: yavta Tainted: G        W          6.7.0-rc2-arm64-renesas #1
[  671.053310] Hardware name: Renesas Salvator-X 2nd version board based on r8a77951 (DT)
[  671.061230] pstate: 20000005 (nzCv daif -PAN -UAO -TCO -DIT -SSBS BTYPE=--)
[  671.068199] pc : call_s_stream+0xd4/0xf0
[  671.072130] lr : vsp1_pipeline_stop+0x10c/0x2a4
[  671.076669] sp : ffff8000899c3a60
[  671.079986] x29: ffff8000899c3a60 x28: ffff80008180fd68 x27: ffff0004c9607200
[  671.087137] x26: ffff0004c37d6740 x25: 0000000000000000 x24: 0000000040045613
[  671.094289] x23: ffff0004c37d6b10 x22: ffff0004c454ec00 x21: 0000000000000000
[  671.101441] x20: ffff0004c385f080 x19: ffff0004c38c98f0 x18: 0000000000000000
[  671.108593] x17: 0000000000000000 x16: 0000000000000000 x15: 0000ffffd70276ec
[  671.115745] x14: 0000000000000000 x13: 0000000000000000 x12: 0000000000040000
[  671.122898] x11: 0000000000000000 x10: ffff8000836e8e78 x9 : 0000000000000000
[  671.130050] x8 : ffff0004c0fe3100 x7 : 0000000000000000 x6 : 0000000000000007
[  671.137201] x5 : 0000000000000000 x4 : ffff800085ba8000 x3 : ffff800080e76a28
[  671.144354] x2 : ffff800080eb8504 x1 : 0000000000000000 x0 : 0000000000000001
[  671.151505] Call trace:
[  671.153956]  call_s_stream+0xd4/0xf0
[  671.157542]  vsp1_pipeline_stop+0x10c/0x2a4
[  671.161731]  vsp1_video_stop_streaming+0x100/0x12c
[  671.166526]  __vb2_queue_cancel+0x2c/0x280
[  671.170629]  vb2_core_streamoff+0x20/0xc0
[  671.174646]  vb2_ioctl_streamoff+0x54/0x9c
[  671.178750]  v4l_streamoff+0x20/0x28
[  671.182333]  __video_do_ioctl+0x18c/0x3ec
[  671.186352]  video_usercopy+0x304/0x894
[  671.190193]  video_ioctl2+0x14/0x2c
[  671.193684]  v4l2_ioctl+0x3c/0x58
[  671.197003]  __arm64_sys_ioctl+0xa0/0xe0
[  671.200935]  invoke_syscall+0x44/0x108
[  671.204694]  el0_svc_common.constprop.0+0xb4/0xd4
[  671.209406]  do_el0_svc+0x18/0x20
[  671.212726]  el0_svc+0x3c/0xb8
[  671.215791]  el0t_64_sync_handler+0xb8/0xbc
[  671.219978]  el0t_64_sync+0x14c/0x150
[  671.223649] irq event stamp: 30688
[  671.227054] hardirqs last  enabled at (30687): [<ffff8000812def1c>] _raw_spin_unlock_irqrestore+0x6c/0x70
[  671.236631] hardirqs last disabled at (30688): [<ffff8000812cc0d8>] el1_dbg+0x20/0x80
[  671.244471] softirqs last  enabled at (30666): [<ffff80008001626c>] put_cpu_fpsimd_context+0x24/0x58
[  671.253613] softirqs last disabled at (30664): [<ffff8000800161fc>] get_cpu_fpsimd_context+0x0/0x4c
[  671.262667] ---[ end trace 0000000000000000 ]---
pass
Testing histogram HGT with hue areas 0,40,40,80,80,120,120,160,160,200,200,255: [  673.655964] ------------[ cut here ]------------
[  673.660614] WARNING: CPU: 0 PID: 5712 at drivers/media/v4l2-core/v4l2-subdev.c:408 call_s_stream+0xd4/0xf0
[  673.670293] Modules linked in: bluetooth ecdh_generic ecc rfkill crct10dif_ce optee_rng rng_core
[  673.679127] CPU: 0 PID: 5712 Comm: yavta Tainted: G        W          6.7.0-rc2-arm64-renesas #1
[  673.687920] Hardware name: Renesas Salvator-X 2nd version board based on r8a77951 (DT)
[  673.695840] pstate: 20000005 (nzCv daif -PAN -UAO -TCO -DIT -SSBS BTYPE=--)
[  673.702808] pc : call_s_stream+0xd4/0xf0
[  673.706737] lr : vsp1_pipeline_stop+0x10c/0x2a4
[  673.711274] sp : ffff80008acbba60
[  673.714591] x29: ffff80008acbba60 x28: ffff80008180fd68 x27: ffff0004c7c67e00
[  673.721744] x26: ffff0004c37d6740 x25: 0000000000000000 x24: 0000000040045613
[  673.728895] x23: ffff0004c37d6b10 x22: ffff0004c3947c00 x21: 0000000000000000
[  673.736045] x20: ffff0004c385f080 x19: ffff0004c38c98f0 x18: 0000000000000000
[  673.743195] x17: 0000000000000000 x16: 0000000000000000 x15: 0000fffff012b5cc
[  673.750345] x14: 0000000000000000 x13: 0000000000000000 x12: 0000000000040000
[  673.757496] x11: 0000000000000000 x10: ffff8000836e8e78 x9 : 0000000000000000
[  673.764645] x8 : ffff0004c3953100 x7 : 0000000000000000 x6 : 0000000000000007
[  673.771795] x5 : 0000000000000000 x4 : ffff800085ba8000 x3 : ffff800080e76a28
[  673.778945] x2 : ffff800080eb8504 x1 : 0000000000000000 x0 : 0000000000000001
[  673.786095] Call trace:
[  673.788544]  call_s_stream+0xd4/0xf0
[  673.792126]  vsp1_pipeline_stop+0x10c/0x2a4
[  673.796314]  vsp1_video_stop_streaming+0x100/0x12c
[  673.801110]  __vb2_queue_cancel+0x2c/0x280
[  673.805215]  vb2_core_streamoff+0x20/0xc0
[  673.809230]  vb2_ioctl_streamoff+0x54/0x9c
[  673.813332]  v4l_streamoff+0x20/0x28
[  673.816914]  __video_do_ioctl+0x18c/0x3ec
[  673.820930]  video_usercopy+0x304/0x894
[  673.824770]  video_ioctl2+0x14/0x2c
[  673.828262]  v4l2_ioctl+0x3c/0x58
[  673.831582]  __arm64_sys_ioctl+0xa0/0xe0
[  673.835514]  invoke_syscall+0x44/0x108
[  673.839271]  el0_svc_common.constprop.0+0xb4/0xd4
[  673.843981]  do_el0_svc+0x18/0x20
[  673.847301]  el0_svc+0x3c/0xb8
[  673.850366]  el0t_64_sync_handler+0xb8/0xbc
[  673.854552]  el0t_64_sync+0x14c/0x150
[  673.858219] irq event stamp: 30348
[  673.861622] hardirqs last  enabled at (30347): [<ffff8000812def1c>] _raw_spin_unlock_irqrestore+0x6c/0x70
[  673.871195] hardirqs last disabled at (30348): [<ffff8000812cc0d8>] el1_dbg+0x20/0x80
[  673.879031] softirqs last  enabled at (30324): [<ffff80008001626c>] put_cpu_fpsimd_context+0x24/0x58
[  673.888168] softirqs last disabled at (30322): [<ffff8000800161fc>] get_cpu_fpsimd_context+0x0/0x4c
[  673.897217] ---[ end trace 0000000000000000 ]---
pass
Testing histogram HGT with hue areas 220,40,40,80,80,120,120,160,160,200,200,220: [  676.485925] ------------[ cut here ]------------
[  676.490576] WARNING: CPU: 1 PID: 5989 at drivers/media/v4l2-core/v4l2-subdev.c:408 call_s_stream+0xd4/0xf0
[  676.500253] Modules linked in: bluetooth ecdh_generic ecc rfkill crct10dif_ce optee_rng rng_core
[  676.509084] CPU: 1 PID: 5989 Comm: yavta Tainted: G        W          6.7.0-rc2-arm64-renesas #1
[  676.517876] Hardware name: Renesas Salvator-X 2nd version board based on r8a77951 (DT)
[  676.525796] pstate: 20000005 (nzCv daif -PAN -UAO -TCO -DIT -SSBS BTYPE=--)
[  676.532763] pc : call_s_stream+0xd4/0xf0
[  676.536696] lr : vsp1_pipeline_stop+0x10c/0x2a4
[  676.541236] sp : ffff80008ca23a60
[  676.544555] x29: ffff80008ca23a60 x28: ffff80008180fd68 x27: ffff0004c9605e00
[  676.551707] x26: ffff0004c37d6740 x25: 0000000000000000 x24: 0000000040045613
[  676.558858] x23: ffff0004c37d6b10 x22: ffff0004c455e000 x21: 0000000000000000
[  676.566009] x20: ffff0004c385f080 x19: ffff0004c38c98f0 x18: 0000000000000000
[  676.573160] x17: 0000000000000000 x16: 0000000000000000 x15: 0000ffffe5a152cc
[  676.580310] x14: 0000000000000000 x13: 0000000000000000 x12: 0000000000040000
[  676.587459] x11: 0000000000000000 x10: ffff8000836e8e78 x9 : 0000000000000000
[  676.594608] x8 : ffff0004c2dfe200 x7 : 0000000000000000 x6 : 0000000000000007
[  676.601758] x5 : 0000000000000000 x4 : ffff800085ba8000 x3 : ffff800080e76a28
[  676.608906] x2 : ffff800080eb8504 x1 : 0000000000000000 x0 : 0000000000000001
[  676.616056] Call trace:
[  676.618506]  call_s_stream+0xd4/0xf0
[  676.622091]  vsp1_pipeline_stop+0x10c/0x2a4
[  676.626282]  vsp1_video_stop_streaming+0x100/0x12c
[  676.631080]  __vb2_queue_cancel+0x2c/0x280
[  676.635186]  vb2_core_streamoff+0x20/0xc0
[  676.639202]  vb2_ioctl_streamoff+0x54/0x9c
[  676.643303]  v4l_streamoff+0x20/0x28
[  676.646886]  __video_do_ioctl+0x18c/0x3ec
[  676.650903]  video_usercopy+0x304/0x894
[  676.654744]  video_ioctl2+0x14/0x2c
[  676.658237]  v4l2_ioctl+0x3c/0x58
[  676.661558]  __arm64_sys_ioctl+0xa0/0xe0
[  676.665490]  invoke_syscall+0x44/0x108
[  676.669252]  el0_svc_common.constprop.0+0xb4/0xd4
[  676.673964]  do_el0_svc+0x18/0x20
[  676.677286]  el0_svc+0x3c/0xb8
[  676.680351]  el0t_64_sync_handler+0xb8/0xbc
[  676.684537]  el0t_64_sync+0x14c/0x150
[  676.688205] irq event stamp: 30752
[  676.691608] hardirqs last  enabled at (30751): [<ffff8000812def1c>] _raw_spin_unlock_irqrestore+0x6c/0x70
[  676.701183] hardirqs last disabled at (30752): [<ffff8000812cc0d8>] el1_dbg+0x20/0x80
[  676.709022] softirqs last  enabled at (30730): [<ffff80008001626c>] put_cpu_fpsimd_context+0x24/0x58
[  676.718162] softirqs last disabled at (30728): [<ffff8000800161fc>] get_cpu_fpsimd_context+0x0/0x4c
[  676.727215] ---[ end trace 0000000000000000 ]---
pass
Testing histogram HGT with hue areas 0,10,50,60,100,110,150,160,200,210,250,255: [  679.238248] ------------[ cut here ]------------
[  679.242895] WARNING: CPU: 2 PID: 6266 at drivers/media/v4l2-core/v4l2-subdev.c:408 call_s_stream+0xd4/0xf0
[  679.252572] Modules linked in: bluetooth ecdh_generic ecc rfkill crct10dif_ce optee_rng rng_core
[  679.261403] CPU: 2 PID: 6266 Comm: yavta Tainted: G        W          6.7.0-rc2-arm64-renesas #1
[  679.270197] Hardware name: Renesas Salvator-X 2nd version board based on r8a77951 (DT)
[  679.278117] pstate: 20000005 (nzCv daif -PAN -UAO -TCO -DIT -SSBS BTYPE=--)
[  679.285086] pc : call_s_stream+0xd4/0xf0
[  679.289018] lr : vsp1_pipeline_stop+0x10c/0x2a4
[  679.293557] sp : ffff80008e183a60
[  679.296874] x29: ffff80008e183a60 x28: ffff80008180fd68 x27: ffff0004c725ae00
[  679.304026] x26: ffff0004c37d6740 x25: 0000000000000000 x24: 0000000040045613
[  679.311178] x23: ffff0004c37d6b10 x22: ffff0004c4549800 x21: 0000000000000000
[  679.318331] x20: ffff0004c385f080 x19: ffff0004c38c98f0 x18: 0000000000000000
[  679.325486] x17: 0000000000000000 x16: 0000000000000000 x15: 0000ffffdad13d6c
[  679.332639] x14: 0000000000000000 x13: 0000000000000000 x12: 0000000000040000
[  679.339791] x11: 0000000000000000 x10: ffff8000836e8e78 x9 : 0000000000000000
[  679.346943] x8 : ffff0004c2466200 x7 : 0000000000000000 x6 : 0000000000000007
[  679.354094] x5 : 0000000000000000 x4 : ffff800085ba8000 x3 : ffff800080e76a28
[  679.361244] x2 : ffff800080eb8504 x1 : 0000000000000000 x0 : 0000000000000001
[  679.368396] Call trace:
[  679.370845]  call_s_stream+0xd4/0xf0
[  679.374430]  vsp1_pipeline_stop+0x10c/0x2a4
[  679.378618]  vsp1_video_stop_streaming+0x100/0x12c
[  679.383416]  __vb2_queue_cancel+0x2c/0x280
[  679.387522]  vb2_core_streamoff+0x20/0xc0
[  679.391538]  vb2_ioctl_streamoff+0x54/0x9c
[  679.395641]  v4l_streamoff+0x20/0x28
[  679.399224]  __video_do_ioctl+0x18c/0x3ec
[  679.403243]  video_usercopy+0x304/0x894
[  679.407084]  video_ioctl2+0x14/0x2c
[  679.410577]  v4l2_ioctl+0x3c/0x58
[  679.413896]  __arm64_sys_ioctl+0xa0/0xe0
[  679.417826]  invoke_syscall+0x44/0x108
[  679.421584]  el0_svc_common.constprop.0+0xb4/0xd4
[  679.426295]  do_el0_svc+0x18/0x20
[  679.429616]  el0_svc+0x3c/0xb8
[  679.432680]  el0t_64_sync_handler+0xb8/0xbc
[  679.436866]  el0t_64_sync+0x14c/0x150
[  679.440535] irq event stamp: 30548
[  679.443939] hardirqs last  enabled at (30547): [<ffff8000812def1c>] _raw_spin_unlock_irqrestore+0x6c/0x70
[  679.453512] hardirqs last disabled at (30548): [<ffff8000812cc0d8>] el1_dbg+0x20/0x80
[  679.461349] softirqs last  enabled at (30526): [<ffff80008001626c>] put_cpu_fpsimd_context+0x24/0x58
[  679.470487] softirqs last disabled at (30524): [<ffff8000800161fc>] get_cpu_fpsimd_context+0x0/0x4c
[  679.479539] ---[ end trace 0000000000000000 ]---
pass
Testing histogram HGT with hue areas 10,20,50,60,100,110,150,160,200,210,230,240: [  681.897862] ------------[ cut here ]------------
[  681.902510] WARNING: CPU: 0 PID: 6543 at drivers/media/v4l2-core/v4l2-subdev.c:408 call_s_stream+0xd4/0xf0
[  681.912191] Modules linked in: bluetooth ecdh_generic ecc rfkill crct10dif_ce optee_rng rng_core
[  681.921024] CPU: 0 PID: 6543 Comm: yavta Tainted: G        W          6.7.0-rc2-arm64-renesas #1
[  681.929817] Hardware name: Renesas Salvator-X 2nd version board based on r8a77951 (DT)
[  681.937734] pstate: 20000005 (nzCv daif -PAN -UAO -TCO -DIT -SSBS BTYPE=--)
[  681.944701] pc : call_s_stream+0xd4/0xf0
[  681.948630] lr : vsp1_pipeline_stop+0x10c/0x2a4
[  681.953165] sp : ffff8000850fba60
[  681.956482] x29: ffff8000850fba60 x28: ffff80008180fd68 x27: ffff0004c48cd200
[  681.963634] x26: ffff0004c37d6740 x25: 0000000000000000 x24: 0000000040045613
[  681.970783] x23: ffff0004c37d6b10 x22: ffff0004c455d000 x21: 0000000000000000
[  681.977932] x20: ffff0004c385f080 x19: ffff0004c38c98f0 x18: 0000000000000000
[  681.985081] x17: 0000000000000000 x16: 0000000000000000 x15: 0000fffff9167bbc
[  681.992228] x14: 0000000000000000 x13: 0000000000000000 x12: 0000000000040000
[  681.999377] x11: 0000000000000000 x10: ffff8000836e8e78 x9 : 0000000000000000
[  682.006525] x8 : ffff0004c0fe0000 x7 : 0000000000000000 x6 : 0000000000000007
[  682.013673] x5 : 0000000000000000 x4 : ffff800085ba8000 x3 : ffff800080e76a28
[  682.020821] x2 : ffff800080eb8504 x1 : 0000000000000000 x0 : 0000000000000001
[  682.027970] Call trace:
[  682.030418]  call_s_stream+0xd4/0xf0
[  682.034000]  vsp1_pipeline_stop+0x10c/0x2a4
[  682.038187]  vsp1_video_stop_streaming+0x100/0x12c
[  682.042982]  __vb2_queue_cancel+0x2c/0x280
[  682.047086]  vb2_core_streamoff+0x20/0xc0
[  682.051100]  vb2_ioctl_streamoff+0x54/0x9c
[  682.055202]  v4l_streamoff+0x20/0x28
[  682.058782]  __video_do_ioctl+0x18c/0x3ec
[  682.062797]  video_usercopy+0x304/0x894
[  682.066635]  video_ioctl2+0x14/0x2c
[  682.070126]  v4l2_ioctl+0x3c/0x58
[  682.073445]  __arm64_sys_ioctl+0xa0/0xe0
[  682.077376]  invoke_syscall+0x44/0x108
[  682.081133]  el0_svc_common.constprop.0+0xb4/0xd4
[  682.085842]  do_el0_svc+0x18/0x20
[  682.089160]  el0_svc+0x3c/0xb8
[  682.092225]  el0t_64_sync_handler+0xb8/0xbc
[  682.096409]  el0t_64_sync+0x14c/0x150
[  682.100077] irq event stamp: 30546
[  682.103480] hardirqs last  enabled at (30545): [<ffff8000812def1c>] _raw_spin_unlock_irqrestore+0x6c/0x70
[  682.113053] hardirqs last disabled at (30546): [<ffff8000812cc0d8>] el1_dbg+0x20/0x80
[  682.120888] softirqs last  enabled at (30282): [<ffff800080010a84>] __do_softirq+0x494/0x4dc
[  682.129328] softirqs last disabled at (30277): [<ffff800080015e18>] ____do_softirq+0xc/0x14
[  682.137683] ---[ end trace 0000000000000000 ]---
pass
Testing histogram HGT with hue areas 240,20,60,80,100,120,140,160,180,200,210,220: [  684.757348] ------------[ cut here ]------------
[  684.762001] WARNING: CPU: 0 PID: 6820 at drivers/media/v4l2-core/v4l2-subdev.c:408 call_s_stream+0xd4/0xf0
[  684.771682] Modules linked in: bluetooth ecdh_generic ecc rfkill crct10dif_ce optee_rng rng_core
[  684.780518] CPU: 0 PID: 6820 Comm: yavta Tainted: G        W          6.7.0-rc2-arm64-renesas #1
[  684.789313] Hardware name: Renesas Salvator-X 2nd version board based on r8a77951 (DT)
[  684.797231] pstate: 20000005 (nzCv daif -PAN -UAO -TCO -DIT -SSBS BTYPE=--)
[  684.804201] pc : call_s_stream+0xd4/0xf0
[  684.808134] lr : vsp1_pipeline_stop+0x10c/0x2a4
[  684.812672] sp : ffff8000851c3a60
[  684.815989] x29: ffff8000851c3a60 x28: ffff80008180fd68 x27: ffff0004c9607e00
[  684.823143] x26: ffff0004c37d6740 x25: 0000000000000000 x24: 0000000040045613
[  684.830296] x23: ffff0004c37d6b10 x22: ffff0004c390a800 x21: 0000000000000000
[  684.837447] x20: ffff0004c385f080 x19: ffff0004c38c98f0 x18: 0000000000000000
[  684.844597] x17: 0000000000000000 x16: 0000000000000000 x15: 0000ffffc839eedc
[  684.851748] x14: 0000000000000000 x13: 0000000000000000 x12: 0000000000040000
[  684.858899] x11: 0000000000000000 x10: ffff8000836e8e78 x9 : 0000000000000000
[  684.866049] x8 : ffff0004c447e200 x7 : 0000000000000000 x6 : 0000000000000007
[  684.873199] x5 : 0000000000000000 x4 : ffff800085ba8000 x3 : ffff800080e76a28
[  684.880349] x2 : ffff800080eb8504 x1 : 0000000000000000 x0 : 0000000000000001
[  684.887499] Call trace:
[  684.889948]  call_s_stream+0xd4/0xf0
[  684.893530]  vsp1_pipeline_stop+0x10c/0x2a4
[  684.897718]  vsp1_video_stop_streaming+0x100/0x12c
[  684.902514]  __vb2_queue_cancel+0x2c/0x280
[  684.906618]  vb2_core_streamoff+0x20/0xc0
[  684.910634]  vb2_ioctl_streamoff+0x54/0x9c
[  684.914736]  v4l_streamoff+0x20/0x28
[  684.918318]  __video_do_ioctl+0x18c/0x3ec
[  684.922334]  video_usercopy+0x304/0x894
[  684.926174]  video_ioctl2+0x14/0x2c
[  684.929666]  v4l2_ioctl+0x3c/0x58
[  684.932986]  __arm64_sys_ioctl+0xa0/0xe0
[  684.936918]  invoke_syscall+0x44/0x108
[  684.940675]  el0_svc_common.constprop.0+0xb4/0xd4
[  684.945384]  do_el0_svc+0x18/0x20
[  684.948705]  el0_svc+0x3c/0xb8
[  684.951770]  el0t_64_sync_handler+0xb8/0xbc
[  684.955956]  el0t_64_sync+0x14c/0x150
[  684.959624] irq event stamp: 30554
[  684.963028] hardirqs last  enabled at (30553): [<ffff8000812def1c>] _raw_spin_unlock_irqrestore+0x6c/0x70
[  684.972602] hardirqs last disabled at (30554): [<ffff8000812cc0d8>] el1_dbg+0x20/0x80
[  684.980438] softirqs last  enabled at (30334): [<ffff800080010a84>] __do_softirq+0x494/0x4dc
[  684.988879] softirqs last disabled at (30325): [<ffff800080015e18>] ____do_softirq+0xc/0x14
[  684.997235] ---[ end trace 0000000000000000 ]---
pass
root@salvator-x:~/v4l2_test# 
root@salvator-x:~/v4l2_test# cd ~
root@salvator-x:~# 
 
#### Result: OK ####
